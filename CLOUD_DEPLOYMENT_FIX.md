# äº‘ç«¯ç¯å¢ƒä¾èµ–é—®é¢˜è§£å†³æ–¹æ¡ˆ

## é—®é¢˜è¯Šæ–­

ä½ é‡åˆ°çš„é”™è¯¯ç—‡çŠ¶ï¼š
- `pip's dependency resolver does not currently take into account all the packages that are installed`
- `stmol 0.0.9 requires ipywidgets==7.6.3, but you have ipywidgets 8.1.8 which is incompatible`
- `streamlit 1.29.0 requires rich<14,>=10.14.0, but you have rich 14.3.2 which is incompatible`
- ç‚¹å‡»"æŸ¥çœ‹åˆ†å­ç»“æ„"åç¨‹åºå´©æºƒ
- æ˜¾ç¤º `plipæ²¡æœ‰å®‰è£…`

## æ ¹æœ¬åŸå› 

**äº‘ç«¯ç¯å¢ƒä¸æ˜¯æ ¹æ®ä¿®æ”¹åçš„ `requirements.txt` æ–°æ„å»ºçš„**ï¼Œä»ç„¶æ®‹ç•™ç€æ—§ç‰ˆæœ¬çš„å†²çªåŒ…ï¼š
- `stmol` ä»ç„¶å­˜åœ¨ï¼ˆåº”å·²ç§»é™¤ï¼‰
- `rich` ç‰ˆæœ¬æ˜¯ 14.3.2ï¼ˆåº”ä¸º 13.7.1ï¼‰
- `ipywidgets` ç‰ˆæœ¬æ˜¯ 8.1.8ï¼ˆåº”ä¸º 7.6.3ï¼‰
- `plip` æœªå®‰è£…

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šå¼ºåˆ¶æ¸…æ´å®‰è£…ï¼ˆæ¨èï¼‰

åœ¨ä½ çš„äº‘ç«¯ç»ˆç«¯ä¸­è¿è¡Œï¼š

**Windows ç”¨æˆ·ï¼š**
```bash
fix_cloud_dependencies.bat
```

**Linux/Mac ç”¨æˆ·ï¼š**
```bash
bash fix_cloud_dependencies.sh
```

### æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤

å¦‚æœè„šæœ¬æ‰§è¡Œå¤±è´¥ï¼Œæ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1. å‡çº§pip
python -m pip install --upgrade pip

# 2. å¼ºåˆ¶å¸è½½æ‰€æœ‰å†²çªåŒ…
pip uninstall -y streamlit stmol rich markdown-it-py pygments ipywidgets plip py3Dmol

# 3. å®‰è£…ä¸¥æ ¼é”å®šçš„Streamlitä¾èµ–
pip install "rich==13.7.1"
pip install "markdown-it-py==2.2.0"
pip install "pygments==2.17.2"
pip install "ipywidgets==7.6.3"

# 4. å®‰è£…Streamlit
pip install "streamlit==1.29.0"

# 5. å®‰è£…å…¶ä»–ä¾èµ–
pip install -r requirements.txt

# æ³¨æ„ï¼šå¦‚æœplipå®‰è£…å¤±è´¥ï¼Œåº”ç”¨ä¼šè‡ªåŠ¨è¿›å…¥é™çº§æ¨¡å¼
```

### æ–¹æ¡ˆä¸‰ï¼šå¿«é€Ÿè¯Šæ–­

è¿è¡Œè¯Šæ–­è„šæœ¬æ£€æŸ¥å½“å‰ç¯å¢ƒçŠ¶æ€ï¼š

```bash
python diagnose_env.py
```

## ä»£ç æ”¹è¿›è¯´æ˜

### 1. ç¯å¢ƒè¯Šæ–­é¢æ¿

åœ¨ `app.py` ä¸­æ·»åŠ äº†å®Œæ•´çš„ç¯å¢ƒè¯Šæ–­åŠŸèƒ½ï¼š
- å±•ç¤ºæ‰€æœ‰å…³é”®åŒ…çš„å½“å‰ç‰ˆæœ¬å’ŒæœŸæœ›ç‰ˆæœ¬
- æ£€æµ‹ä¾èµ–å†²çª
- æä¾›ä¿®å¤å»ºè®®

**ä½¿ç”¨æ–¹æ³•**ï¼šåœ¨ä¾§è¾¹æ ç‚¹å‡»"ğŸ” ç¯å¢ƒè¯Šæ–­"å±•å¼€æŸ¥çœ‹

### 2. PLIP é™çº§æ¨¡å¼

åœ¨ `protein_ligand_streamlit.py` ä¸­ï¼š
- æ·»åŠ äº† `PLIP_AVAILABLE` æ ‡å¿—
- å¦‚æœ PLIP æœªå®‰è£…ï¼Œåº”ç”¨ä¼šï¼š
  - æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
  - ä»…ç¦ç”¨ PLIP åˆ†æåŠŸèƒ½
  - 3D å¯è§†åŒ–ä»ç„¶å¯ç”¨ï¼ˆéœ€è¦ py3Dmolï¼‰

### 3. å®‰è£…è„šæœ¬æ”¹è¿›

ä¿®å¤åçš„è„šæœ¬ä¼šï¼š
- å¼ºåˆ¶å¸è½½å†²çªåŒ…
- ä¸¥æ ¼æŒ‰ç‰ˆæœ¬å®‰è£…ä¾èµ–
- å…è®¸ PLIP å®‰è£…å¤±è´¥ï¼ˆè¿›å…¥é™çº§æ¨¡å¼ï¼‰

## é¢„æœŸç»“æœ

æ‰§è¡Œä¿®å¤åï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š

```
âœ… streamlit: 1.29.0
âœ… rich: 13.7.1
âœ… ipywidgets: 7.6.3
âœ… py3Dmol: 2.0.0.post2
âœ… rdkit-pypi: 2022.9.5
âœ… stmol: æœªå®‰è£…ï¼ˆæ­£ç¡®ï¼‰
âš ï¸  plip: æœªå®‰è£…ï¼ˆé™çº§æ¨¡å¼ï¼‰
```

## å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

1. **æä¾›è¯Šæ–­ä¿¡æ¯**ï¼š
   - è¿è¡Œ `python diagnose_env.py` å¹¶æˆªå›¾è¾“å‡º
   - åœ¨åº”ç”¨ä¸­æŸ¥çœ‹"ç¯å¢ƒè¯Šæ–­"é¢æ¿æˆªå›¾

2. **æä¾›é”™è¯¯æ—¥å¿—**ï¼š
   - ç‚¹å‡»"æŸ¥çœ‹åˆ†å­ç»“æ„"åçš„å®Œæ•´é”™è¯¯å †æ ˆ

3. **äº‘ç«¯ç¯å¢ƒé™åˆ¶**ï¼š
   - æŸäº›äº‘ç«¯å¹³å°ï¼ˆå¦‚ Streamlit Cloudï¼‰å¯èƒ½å®Œå…¨ç¦æ­¢ PLIP å®‰è£…
   - è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œåº”ç”¨ä¼šè‡ªåŠ¨é™çº§ï¼Œä¸å½±å“æ ¸å¿ƒåŠŸèƒ½

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆ `stmol` å¿…é¡»ç§»é™¤ï¼Ÿ
A: `stmol` ä¸æˆ‘ä»¬å½“å‰çš„é…ç½®ä¸å…¼å®¹ï¼Œä¸”å·²è¢« `py3Dmol` æ›¿ä»£ã€‚

### Q: PLIP æœªå®‰è£…ä¼šå½±å“ä»€ä¹ˆï¼Ÿ
A: ä»…å½±å“"è›‹ç™½è´¨-é…ä½“ç›¸äº’ä½œç”¨åˆ†æ"çš„è¯¦ç»†åˆ†æåŠŸèƒ½ã€‚3D å¯è§†åŒ–ä»ç„¶å¯ç”¨ã€‚

### Q: å¦‚ä½•ç¡®è®¤é—®é¢˜å·²è§£å†³ï¼Ÿ
A: è¿è¡Œ `python diagnose_env.py`ï¼Œæ‰€æœ‰æ ¸å¿ƒä¾èµ–åº”æ˜¾ç¤º âœ…ï¼Œä¸”æ— ä¾èµ–å†²çªã€‚

---

**æ€»ç»“**ï¼šæ‰§è¡Œ `fix_cloud_dependencies.bat`ï¼ˆWindowsï¼‰æˆ– `bash fix_cloud_dependencies.sh`ï¼ˆLinux/Macï¼‰å³å¯è§£å†³æ‰€æœ‰ä¾èµ–é—®é¢˜ã€‚å¦‚æœ plip å®‰è£…å¤±è´¥ï¼Œåº”ç”¨ä¼šè‡ªåŠ¨è¿›å…¥é™çº§æ¨¡å¼ï¼Œä¸å½±å“æ ¸å¿ƒåŠŸèƒ½ã€‚
